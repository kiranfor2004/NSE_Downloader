
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NSE Professional Dashboard - Unified</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: #1A1A1A;
            color: #E0E0E0;
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            background: linear-gradient(135deg, #1A1A1A, #2C2C2C);
            padding: 30px;
            border-radius: 20px;
            border: 2px solid #00B0FF;
            box-shadow: 0 10px 30px rgba(0, 176, 255, 0.2);
        }
        
        .header h1 {
            color: #00B0FF;
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(0, 176, 255, 0.3);
        }
        
        .header p {
            color: #E0E0E0;
            font-size: 1.3rem;
            font-weight: 400;
        }
        
        .tab-navigation {
            display: flex;
            background: #2C2C2C;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 1px solid #404040;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .tab-button {
            flex: 1;
            padding: 20px 40px;
            background: transparent;
            color: #E0E0E0;
            border: none;
            cursor: pointer;
            font-size: 1.2rem;
            font-weight: 600;
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .tab-button.active {
            background: linear-gradient(135deg, #00B0FF, #0288D1);
            color: #FFFFFF;
            box-shadow: inset 0 0 20px rgba(255, 255, 255, 0.1);
        }
        
        .tab-button:hover:not(.active) {
            background: #404040;
            color: #00B0FF;
        }
        
        .tab-button::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: #00B0FF;
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .tab-button.active::after {
            transform: scaleX(1);
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .kpi-card {
            background: linear-gradient(135deg, #2C2C2C, #3C3C3C);
            padding: 30px;
            border-radius: 18px;
            text-align: center;
            border: 1px solid #404040;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .kpi-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, #00C853, #00B0FF, #D50000);
        }
        
        .kpi-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 35px rgba(0, 176, 255, 0.15);
        }
        
        .kpi-value {
            font-size: 2.8rem;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #00B0FF, #00C853);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .kpi-value.positive { 
            background: linear-gradient(45deg, #00C853, #4CAF50);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .kpi-value.negative { 
            background: linear-gradient(45deg, #D50000, #F44336);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .kpi-label {
            font-size: 1rem;
            color: #B0B0B0;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 500;
        }
        
        .charts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .chart-card {
            background: #2C2C2C;
            border-radius: 20px;
            padding: 30px;
            border: 1px solid #404040;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .chart-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, #00B0FF, #00C853);
        }
        
        .chart-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }
        
        .chart-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #00B0FF;
            margin-bottom: 25px;
            text-align: center;
            border-bottom: 2px solid #404040;
            padding-bottom: 15px;
        }
        
        .chart-container {
            height: 450px;
            position: relative;
        }
        
        .symbol-search {
            background: #2C2C2C;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 1px solid #404040;
        }
        
        .search-input {
            width: 100%;
            padding: 15px 20px;
            background: #3C3C3C;
            border: 2px solid #404040;
            border-radius: 10px;
            color: #E0E0E0;
            font-size: 1.1rem;
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s ease;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #00B0FF;
            box-shadow: 0 0 15px rgba(0, 176, 255, 0.3);
        }
        
        .suggestions {
            background: #3C3C3C;
            border: 1px solid #404040;
            border-radius: 10px;
            margin-top: 10px;
            max-height: 200px;
            overflow-y: auto;
            display: none;
        }
        
        .suggestion-item {
            padding: 12px 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 1px solid #404040;
        }
        
        .suggestion-item:last-child {
            border-bottom: none;
        }
        
        .suggestion-item:hover {
            background: #4C4C4C;
            color: #00B0FF;
        }
        
        .symbol-info {
            background: #3C3C3C;
            padding: 20px;
            border-radius: 10px;
            margin-top: 15px;
            border: 1px solid #404040;
            display: none;
        }
        
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #B0B0B0;
            font-size: 1.2rem;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #404040;
            border-top: 4px solid #00B0FF;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .highlight {
            background: linear-gradient(45deg, #00B0FF, #00C853);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 700;
        }
        
        .error-message {
            color: #D50000;
            background: rgba(213, 0, 0, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border: 1px solid #D50000;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ NSE Professional Dashboard</h1>
            <p>Unified Market Intelligence & Symbol Analysis ‚Ä¢ <span class="highlight">2025-09-16 18:47:34</span></p>
        </div>
        
        <div class="tab-navigation">
            <button class="tab-button active" onclick="showTab('market-overview', this)">
                üìä Market Overview
            </button>
            <button class="tab-button" onclick="showTab('symbol-analysis', this)">
                üîç Symbol Analysis
            </button>
        </div>
        
        <!-- Market Overview Tab -->
        <div id="market-overview" class="tab-content active">
            <div class="kpi-grid">
                <div class="kpi-card">
                    <div class="kpi-value positive" id="delivery-increase-lakhs">-</div>
                    <div class="kpi-label">Total Market Delivery Increase (Lakhs)</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-value" id="positive-growth-count">-</div>
                    <div class="kpi-label">Stocks with Positive Delivery Growth</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-value" id="delivery-turnover-ratio">-</div>
                    <div class="kpi-label">Market Delivery-to-Turnover Ratio (%)</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-value" id="avg-turnover">-</div>
                    <div class="kpi-label">Average Daily Turnover (‚Çπ Lacs)</div>
                </div>
            </div>
            
            <div class="charts-grid">
                <div class="chart-card">
                    <div class="chart-title">üó∫Ô∏è Category Turnover Treemap</div>
                    <div class="chart-container" id="treemap-chart">
                        <div class="loading">
                            <div class="spinner"></div>
                            Loading Treemap...
                        </div>
                    </div>
                </div>
                
                <div class="chart-card">
                    <div class="chart-title">üéØ Delivery vs Turnover Scatter</div>
                    <div class="chart-container" id="scatter-chart">
                        <div class="loading">
                            <div class="spinner"></div>
                            Loading Scatter Plot...
                        </div>
                    </div>
                </div>
                
                <div class="chart-card">
                    <div class="chart-title">ü•ß Sector Distribution</div>
                    <div class="chart-container" id="pie-chart">
                        <div class="loading">
                            <div class="spinner"></div>
                            Loading Pie Chart...
                        </div>
                    </div>
                </div>
                
                <div class="chart-card">
                    <div class="chart-title">üìà Top Performers Bar Chart</div>
                    <div class="chart-container" id="bar-chart">
                        <div class="loading">
                            <div class="spinner"></div>
                            Loading Bar Chart...
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Symbol Analysis Tab -->
        <div id="symbol-analysis" class="tab-content">
            <div class="symbol-search">
                <input type="text" class="search-input" placeholder="üîç Search for a symbol (e.g., RELIANCE, TCS, HDFCBANK...)" id="symbol-search-input">
                <div class="suggestions" id="suggestions"></div>
                <div class="symbol-info" id="symbol-info">
                    <h3 id="selected-symbol" style="color: #00B0FF; margin-bottom: 20px; text-align: center;">-</h3>
                    <div class="kpi-grid">
                        <div class="kpi-card">
                            <div class="kpi-value" id="symbol-delivery">-</div>
                            <div class="kpi-label">Current Delivery %</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-value" id="symbol-change">-</div>
                            <div class="kpi-label">Delivery Change %</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-value" id="symbol-volume">-</div>
                            <div class="kpi-label">Daily Volume</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-value" id="symbol-price">-</div>
                            <div class="kpi-label">Current Price (‚Çπ)</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="charts-grid">
                <div class="chart-card">
                    <div class="chart-title">üìà OHLC Price Analysis</div>
                    <div class="chart-container" id="price-chart">
                        <div class="loading">
                            Select a symbol to view price analysis...
                        </div>
                    </div>
                </div>
                
                <div class="chart-card">
                    <div class="chart-title">üìä Delivery Performance Gauge</div>
                    <div class="chart-container" id="metrics-chart">
                        <div class="loading">
                            Select a symbol to view delivery metrics...
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Consolidated dashboard data
        const dashboardData = {
  "market_overview": {
    "kpis": {
      "total_delivery_increase_lakhs": 148812.49,
      "positive_delivery_growth_count": 2107,
      "delivery_turnover_ratio": 11478.38,
      "avg_daily_turnover": 108798.48
    },
    "treemap_data": {
      "categories": [
        "Broad Market",
        "Other",
        "Sectoral"
      ],
      "turnovers": [
        66355675.41,
        192449823.17,
        13190708.0
      ],
      "delivery_pcts": [
        58.34,
        31.07,
        48.17
      ],
      "symbol_counts": [
        488,
        1825,
        187
      ]
    },
    "scatter_data": {
      "symbols": [
        "BHARTIARTL",
        "ITC",
        "BHARTIARTL",
        "INDIGO",
        "ETERNAL",
        "VMM",
        "VMM",
        "ETERNAL",
        "ETERNAL",
        "INDIGO",
        "BSE",
        "ZOMATO",
        "ICICIBANK",
        "ETERNAL",
        "INDUSINDBK"
      ],
      "delivery_increases": [
        716.99,
        1303.97,
        507.85,
        1873.42,
        218.94,
        4119.89,
        4119.89,
        117.68,
        756.29,
        556.73,
        56.34,
        347.83,
        237.23,
        52.97,
        0.0
      ],
      "turnovers": [
        1827196.66,
        1792550.84,
        1755037.12,
        1508499.79,
        1394264.37,
        1335219.81,
        1335219.81,
        1147538.95,
        1110272.13,
        1080083.58,
        1004357.95,
        824001.48,
        811585.65,
        811087.65,
        730750.15
      ],
      "sectors": [
        "Others",
        "FMCG",
        "Others",
        "Others",
        "Others",
        "Others",
        "Others",
        "Others",
        "Others",
        "Others",
        "Others",
        "Others",
        "Banking",
        "Others",
        "Others"
      ]
    },
    "pie_data": {
      "sectors": [
        "Auto",
        "Banking",
        "Energy",
        "FMCG",
        "IT",
        "Others"
      ],
      "delivery_qtys": [
        99338457.0,
        3014105307.0,
        617563529.0,
        518808294.0,
        275578221.0,
        26587788010.0
      ]
    },
    "bar_data": {
      "symbols": [
        "BHARTIARTL",
        "ITC",
        "BHARTIARTL",
        "INDIGO",
        "ETERNAL",
        "VMM",
        "VMM",
        "ETERNAL",
        "ETERNAL",
        "INDIGO",
        "BSE",
        "ZOMATO",
        "ICICIBANK",
        "ETERNAL",
        "INDUSINDBK"
      ],
      "delivery_pcts": [
        75.06,
        75.06,
        71.74,
        78.43,
        67.81,
        78.68,
        78.68,
        51.83,
        60.89,
        50.25,
        12.62,
        75.63,
        81.17,
        34.62,
        13.14
      ],
      "price_changes": [
        -2.849185946872322,
        -3.157409541368979,
        -3.328825548736087,
        -1.964944649446494,
        -0.422866092404072,
        1.537845414497397,
        1.537845414497397,
        0.970386481512464,
        4.352585716162368,
        -5.338842975206612,
        16.98101123955298,
        1.470805253578632,
        1.61912688204585,
        10.34228928965771,
        4.382956017989176
      ]
    }
  },
  "symbol_analysis": {
    "top_symbols": [
      "BHARTIARTL",
      "ITC",
      "BHARTIARTL",
      "INDIGO",
      "ETERNAL",
      "VMM",
      "VMM",
      "ETERNAL",
      "ETERNAL",
      "INDIGO",
      "BSE",
      "ZOMATO",
      "ICICIBANK",
      "ETERNAL",
      "INDUSINDBK",
      "BSE",
      "INDUSINDBK",
      "COCHINSHIP",
      "HINDZINC",
      "HINDZINC",
      "WAAREEENER",
      "TRENT",
      "TRENT",
      "MAZDOCK",
      "OLAELEC",
      "INDUSINDBK",
      "SWIGGY",
      "COCHINSHIP",
      "COCHINSHIP",
      "ETERNAL",
      "HYUNDAI",
      "HDFCBANK",
      "HDFCBANK",
      "BEL",
      "BEL",
      "VMM",
      "BSE",
      "WAAREEENER",
      "HDFCBANK",
      "HDFCBANK",
      "BSE",
      "BSE",
      "RELIANCE",
      "HDFCBANK",
      "IEX",
      "JIOFIN",
      "OLAELEC",
      "RELIANCE",
      "RELIANCE",
      "RELIANCE"
    ],
    "symbol_data": {
      "BHARTIARTL": {
        "delivery_percentage": 71.74,
        "price_change_pct": -3.328825548736087,
        "volume": 93801105,
        "turnover": 1755037.12,
        "close_price": 1858.6,
        "high_price": 1893.8,
        "low_price": 1856.0,
        "open_price": 1886.3,
        "delivery_increase_pct": 507.85,
        "sector": "Others"
      },
      "ITC": {
        "delivery_percentage": 75.06,
        "price_change_pct": -3.157409541368979,
        "volume": 431851622,
        "turnover": 1792550.84,
        "close_price": 420.2,
        "high_price": 422.6,
        "low_price": 413.0,
        "open_price": 417.7,
        "delivery_increase_pct": 1303.97,
        "sector": "FMCG"
      },
      "INDIGO": {
        "delivery_percentage": 50.25,
        "price_change_pct": -5.338842975206612,
        "volume": 18614885,
        "turnover": 1080083.58,
        "close_price": 5727.0,
        "high_price": 5875.0,
        "low_price": 5709.5,
        "open_price": 5875.0,
        "delivery_increase_pct": 556.73,
        "sector": "Others"
      },
      "ETERNAL": {
        "delivery_percentage": 67.29,
        "price_change_pct": -0.886243386243386,
        "volume": 224659198,
        "turnover": 504960.53,
        "close_price": 224.79,
        "high_price": 227.47,
        "low_price": 221.1,
        "open_price": 226.4,
        "delivery_increase_pct": 354.69,
        "sector": "Others"
      },
      "VMM": {
        "delivery_percentage": 65.44,
        "price_change_pct": 2.854456310027537,
        "volume": 318291485,
        "turnover": 486179.57,
        "close_price": 153.14,
        "high_price": 157.6,
        "low_price": 146.51,
        "open_price": 149.6,
        "delivery_increase_pct": 813.29,
        "sector": "Others"
      },
      "BSE": {
        "delivery_percentage": 31.04,
        "price_change_pct": -6.038995523860102,
        "volume": 18415480,
        "turnover": 458134.33,
        "close_price": 2477.0,
        "high_price": 2644.0,
        "low_price": 2395.0,
        "open_price": 2640.0,
        "delivery_increase_pct": 46.19,
        "sector": "Others"
      },
      "ZOMATO": {
        "delivery_percentage": 75.63,
        "price_change_pct": 1.470805253578632,
        "volume": 400414753,
        "turnover": 824001.48,
        "close_price": 206.28,
        "high_price": 208.75,
        "low_price": 200.37,
        "open_price": 204.47,
        "delivery_increase_pct": 347.83,
        "sector": "Others"
      },
      "ICICIBANK": {
        "delivery_percentage": 81.17,
        "price_change_pct": 1.61912688204585,
        "volume": 60494318,
        "turnover": 811585.65,
        "close_price": 1343.1,
        "high_price": 1349.0,
        "low_price": 1311.6,
        "open_price": 1316.0,
        "delivery_increase_pct": 237.23,
        "sector": "Banking"
      },
      "INDUSINDBK": {
        "delivery_percentage": 51.46,
        "price_change_pct": -5.407471099646508,
        "volume": 55666745,
        "turnover": 551244.38,
        "close_price": 990.1,
        "high_price": 1040.65,
        "low_price": 970.1,
        "open_price": 1040.0,
        "delivery_increase_pct": 729.5,
        "sector": "Others"
      },
      "COCHINSHIP": {
        "delivery_percentage": 18.2,
        "price_change_pct": 12.656347342694206,
        "volume": 23864711,
        "turnover": 537361.17,
        "close_price": 2350.8,
        "high_price": 2380.0,
        "low_price": 2041.3,
        "open_price": 2108.0,
        "delivery_increase_pct": 1.86,
        "sector": "Others"
      },
      "HINDZINC": {
        "delivery_percentage": 49.68,
        "price_change_pct": -6.898324252081834,
        "volume": 142069446,
        "turnover": 647642.73,
        "close_price": 452.8,
        "high_price": 465.0,
        "low_price": 451.2,
        "open_price": 462.0,
        "delivery_increase_pct": 4153.83,
        "sector": "Others"
      },
      "WAAREEENER": {
        "delivery_percentage": 59.96,
        "price_change_pct": 3.62413125575196,
        "volume": 14456797,
        "turnover": 469510.72,
        "close_price": 3265.3,
        "high_price": 3329.8,
        "low_price": 3115.0,
        "open_price": 3149.0,
        "delivery_increase_pct": 448.53,
        "sector": "Others"
      },
      "TRENT": {
        "delivery_percentage": 72.18,
        "price_change_pct": 3.040097842229405,
        "volume": 10424185,
        "turnover": 613948.06,
        "close_price": 5897.5,
        "high_price": 6030.0,
        "low_price": 5720.0,
        "open_price": 5756.0,
        "delivery_increase_pct": 728.26,
        "sector": "Others"
      },
      "MAZDOCK": {
        "delivery_percentage": 16.14,
        "price_change_pct": 10.683760683760685,
        "volume": 16561103,
        "turnover": 569206.45,
        "close_price": 3522.4,
        "high_price": 3578.0,
        "low_price": 3186.0,
        "open_price": 3200.0,
        "delivery_increase_pct": 1.98,
        "sector": "Others"
      },
      "OLAELEC": {
        "delivery_percentage": 17.79,
        "price_change_pct": 7.910271546635183,
        "volume": 779430294,
        "turnover": 424378.79,
        "close_price": 54.84,
        "high_price": 56.22,
        "low_price": 51.15,
        "open_price": 51.15,
        "delivery_increase_pct": 26.39,
        "sector": "Others"
      },
      "SWIGGY": {
        "delivery_percentage": 70.8,
        "price_change_pct": 1.151180547398097,
        "volume": 126308057,
        "turnover": 542963.3,
        "close_price": 430.55,
        "high_price": 439.4,
        "low_price": 419.0,
        "open_price": 427.0,
        "delivery_increase_pct": 181.28,
        "sector": "Others"
      },
      "HYUNDAI": {
        "delivery_percentage": 54.11,
        "price_change_pct": 0.400464306442252,
        "volume": 29179375,
        "turnover": 504603.77,
        "close_price": 1729.9,
        "high_price": 1813.45,
        "low_price": 1656.0,
        "open_price": 1760.0,
        "delivery_increase_pct": 801.2,
        "sector": "Others"
      },
      "HDFCBANK": {
        "delivery_percentage": 71.86,
        "price_change_pct": 1.795443931295729,
        "volume": 22980875,
        "turnover": 449772.16,
        "close_price": 1961.7,
        "high_price": 1970.6,
        "low_price": 1935.0,
        "open_price": 1935.0,
        "delivery_increase_pct": 11.46,
        "sector": "Banking"
      },
      "BEL": {
        "delivery_percentage": 78.96,
        "price_change_pct": 2.433822606950194,
        "volume": 122552435,
        "turnover": 499413.67,
        "close_price": 408.25,
        "high_price": 410.0,
        "low_price": 397.75,
        "open_price": 399.0,
        "delivery_increase_pct": 221.59,
        "sector": "Others"
      },
      "RELIANCE": {
        "delivery_percentage": 57.67,
        "price_change_pct": 5.259920024607813,
        "volume": 31104496,
        "turnover": 421471.23,
        "close_price": 1368.8,
        "high_price": 1374.6,
        "low_price": 1320.2,
        "open_price": 1340.0,
        "delivery_increase_pct": 6.13,
        "sector": "Energy"
      },
      "IEX": {
        "delivery_percentage": 12.87,
        "price_change_pct": 9.59794437726723,
        "volume": 298471535,
        "turnover": 431467.52,
        "close_price": 145.02,
        "high_price": 149.4,
        "low_price": 136.41,
        "open_price": 137.8,
        "delivery_increase_pct": 110.38,
        "sector": "Others"
      },
      "JIOFIN": {
        "delivery_percentage": 78.21,
        "price_change_pct": 1.396685678358108,
        "volume": 188868886,
        "turnover": 425794.3,
        "close_price": 225.78,
        "high_price": 228.0,
        "low_price": 221.33,
        "open_price": 222.17,
        "delivery_increase_pct": 407.86,
        "sector": "Others"
      }
    }
  }
};
        
        console.log('Unified dashboard loaded with', Object.keys(dashboardData.symbol_analysis.symbol_data).length, 'symbols');
        
        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            try {
                initializeMarketOverview();
                setupSymbolSearch();
                console.log('Unified dashboard initialized successfully');
            } catch (error) {
                console.error('Dashboard initialization error:', error);
                showError('Error initializing dashboard: ' + error.message);
            }
        });
        
        function showError(message) {
            const container = document.querySelector('.container');
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-message';
            errorDiv.textContent = message;
            container.insertBefore(errorDiv, container.firstChild);
        }
        
        function showTab(tabId, buttonElement) {
            try {
                // Hide all tabs
                document.querySelectorAll('.tab-content').forEach(tab => {
                    tab.classList.remove('active');
                });
                
                // Remove active class from all buttons
                document.querySelectorAll('.tab-button').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // Show selected tab
                const targetTab = document.getElementById(tabId);
                if (targetTab) {
                    targetTab.classList.add('active');
                }
                
                // Activate clicked button
                if (buttonElement) {
                    buttonElement.classList.add('active');
                }
                
                // Initialize charts for the active tab
                setTimeout(() => {
                    if (tabId === 'market-overview') {
                        initializeMarketOverview();
                    } else if (tabId === 'symbol-analysis') {
                        initializeSymbolAnalysis();
                    }
                }, 100);
            } catch (error) {
                console.error('Tab switching error:', error);
                showError('Error switching tabs: ' + error.message);
            }
        }
        
        function initializeMarketOverview() {
            try {
                updateMarketKPIs();
                createTreemapChart();
                createScatterChart();
                createPieChart();
                createBarChart();
            } catch (error) {
                console.error('Market overview initialization error:', error);
                showError('Error loading market overview: ' + error.message);
            }
        }
        
        function initializeSymbolAnalysis() {
            console.log('Symbol analysis tab activated');
        }
        
        function updateMarketKPIs() {
            const kpis = dashboardData.market_overview.kpis;
            
            document.getElementById('delivery-increase-lakhs').textContent = kpis.total_delivery_increase_lakhs.toLocaleString();
            document.getElementById('positive-growth-count').textContent = kpis.positive_delivery_growth_count.toLocaleString();
            document.getElementById('delivery-turnover-ratio').textContent = kpis.delivery_turnover_ratio.toFixed(2) + '%';
            document.getElementById('avg-turnover').textContent = '‚Çπ' + kpis.avg_daily_turnover.toLocaleString();
        }
        
        function createTreemapChart() {
            try {
                const container = document.getElementById('treemap-chart');
                const data = dashboardData.market_overview.treemap_data;
                
                if (!data.categories || data.categories.length === 0) {
                    container.innerHTML = '<div class="loading">No data available</div>';
                    return;
                }
                
                const plotlyData = [{
                    type: 'treemap',
                    labels: data.categories,
                    parents: Array(data.categories.length).fill(''),
                    values: data.turnovers,
                    textinfo: 'label+value',
                    textfont: { color: '#FFFFFF', size: 12 },
                    marker: {
                        colorscale: [[0, '#D50000'], [0.5, '#00B0FF'], [1, '#00C853']],
                        showscale: false,
                        line: { color: '#1A1A1A', width: 2 }
                    },
                    hovertemplate: '<b>%{label}</b><br>Turnover: ‚Çπ%{value:,.0f} Lacs<br>Avg Delivery: %{customdata:.1f}%<br>Symbols: %{customdata2}<extra></extra>',
                    customdata: data.delivery_pcts,
                    customdata2: data.symbol_counts
                }];
                
                const layout = {
                    font: { color: '#E0E0E0', family: 'Poppins' },
                    paper_bgcolor: 'transparent',
                    plot_bgcolor: 'transparent',
                    margin: { t: 10, b: 10, l: 10, r: 10 }
                };
                
                Plotly.newPlot(container, plotlyData, layout, { responsive: true, displayModeBar: false });
            } catch (error) {
                console.error('Treemap chart error:', error);
                document.getElementById('treemap-chart').innerHTML = '<div class="error-message">Error loading treemap</div>';
            }
        }
        
        function createScatterChart() {
            try {
                const container = document.getElementById('scatter-chart');
                const data = dashboardData.market_overview.scatter_data;
                
                if (!data.symbols || data.symbols.length === 0) {
                    container.innerHTML = '<div class="loading">No data available</div>';
                    return;
                }
                
                const plotlyData = [{
                    x: data.delivery_increases,
                    y: data.turnovers,
                    mode: 'markers+text',
                    type: 'scatter',
                    text: data.symbols,
                    textposition: 'middle center',
                    marker: {
                        size: data.turnovers.map(t => Math.max(10, Math.min(30, t/10000))),
                        color: data.delivery_increases,
                        colorscale: [[0, '#D50000'], [0.5, '#00B0FF'], [1, '#00C853']],
                        showscale: true,
                        colorbar: {
                            title: 'Delivery Increase %',
                            titlefont: { color: '#E0E0E0' },
                            tickfont: { color: '#E0E0E0' }
                        },
                        line: { color: '#FFFFFF', width: 1 }
                    },
                    hovertemplate: '<b>%{text}</b><br>Delivery Increase: %{x:.1f}%<br>Turnover: ‚Çπ%{y:,.0f} Lacs<br>Sector: %{customdata}<extra></extra>',
                    customdata: data.sectors
                }];
                
                const layout = {
                    font: { color: '#E0E0E0', family: 'Poppins' },
                    paper_bgcolor: 'transparent',
                    plot_bgcolor: 'transparent',
                    xaxis: { 
                        title: 'Delivery Increase %',
                        gridcolor: '#404040',
                        titlefont: { color: '#E0E0E0' },
                        tickfont: { color: '#E0E0E0' }
                    },
                    yaxis: { 
                        title: 'Turnover (‚Çπ Lacs)',
                        gridcolor: '#404040',
                        titlefont: { color: '#E0E0E0' },
                        tickfont: { color: '#E0E0E0' }
                    },
                    margin: { t: 10, b: 50, l: 80, r: 10 }
                };
                
                Plotly.newPlot(container, plotlyData, layout, { responsive: true, displayModeBar: false });
            } catch (error) {
                console.error('Scatter chart error:', error);
                document.getElementById('scatter-chart').innerHTML = '<div class="error-message">Error loading scatter chart</div>';
            }
        }
        
        function createPieChart() {
            try {
                const container = document.getElementById('pie-chart');
                const data = dashboardData.market_overview.pie_data;
                
                if (!data.sectors || data.sectors.length === 0) {
                    container.innerHTML = '<div class="loading">No data available</div>';
                    return;
                }
                
                const plotlyData = [{
                    values: data.delivery_qtys,
                    labels: data.sectors,
                    type: 'pie',
                    textinfo: 'label+percent',
                    textfont: { color: '#FFFFFF' },
                    marker: {
                        colors: ['#00C853', '#00B0FF', '#D50000', '#FF9800', '#9C27B0', '#4CAF50'],
                        line: { color: '#1A1A1A', width: 2 }
                    },
                    hovertemplate: '<b>%{label}</b><br>Delivery Qty: %{value:,.0f}<br>%{percent}<extra></extra>'
                }];
                
                const layout = {
                    font: { color: '#E0E0E0', family: 'Poppins' },
                    paper_bgcolor: 'transparent',
                    plot_bgcolor: 'transparent',
                    margin: { t: 10, b: 10, l: 10, r: 10 },
                    legend: { font: { color: '#E0E0E0' } }
                };
                
                Plotly.newPlot(container, plotlyData, layout, { responsive: true, displayModeBar: false });
            } catch (error) {
                console.error('Pie chart error:', error);
                document.getElementById('pie-chart').innerHTML = '<div class="error-message">Error loading pie chart</div>';
            }
        }
        
        function createBarChart() {
            try {
                const container = document.getElementById('bar-chart');
                const data = dashboardData.market_overview.bar_data;
                
                if (!data.symbols || data.symbols.length === 0) {
                    container.innerHTML = '<div class="loading">No data available</div>';
                    return;
                }
                
                const plotlyData = [{
                    x: data.symbols,
                    y: data.delivery_pcts,
                    type: 'bar',
                    marker: {
                        color: data.price_changes,
                        colorscale: [[0, '#D50000'], [0.5, '#00B0FF'], [1, '#00C853']],
                        showscale: false,
                        line: { color: '#1A1A1A', width: 1 }
                    },
                    hovertemplate: '<b>%{x}</b><br>Delivery: %{y:.1f}%<br>Price Change: %{customdata:.1f}%<extra></extra>',
                    customdata: data.price_changes
                }];
                
                const layout = {
                    font: { color: '#E0E0E0', family: 'Poppins' },
                    paper_bgcolor: 'transparent',
                    plot_bgcolor: 'transparent',
                    xaxis: { 
                        title: 'Top Performing Symbols',
                        gridcolor: '#404040',
                        titlefont: { color: '#E0E0E0' },
                        tickfont: { color: '#E0E0E0' }
                    },
                    yaxis: { 
                        title: 'Delivery Percentage (%)',
                        gridcolor: '#404040',
                        titlefont: { color: '#E0E0E0' },
                        tickfont: { color: '#E0E0E0' }
                    },
                    margin: { t: 10, b: 80, l: 60, r: 10 }
                };
                
                Plotly.newPlot(container, plotlyData, layout, { responsive: true, displayModeBar: false });
            } catch (error) {
                console.error('Bar chart error:', error);
                document.getElementById('bar-chart').innerHTML = '<div class="error-message">Error loading bar chart</div>';
            }
        }
        
        function setupSymbolSearch() {
            try {
                const searchInput = document.getElementById('symbol-search-input');
                const suggestions = document.getElementById('suggestions');
                const symbolInfo = document.getElementById('symbol-info');
                const topSymbols = dashboardData.symbol_analysis.top_symbols;
                
                searchInput.addEventListener('input', function() {
                    const searchTerm = this.value.toUpperCase();
                    
                    if (searchTerm.length >= 1) {
                        const matches = topSymbols.filter(symbol => symbol.includes(searchTerm)).slice(0, 10);
                        
                        if (matches.length > 0) {
                            suggestions.innerHTML = matches.map(symbol => 
                                `<div class="suggestion-item" onclick="selectSymbol('${symbol}')">${symbol}</div>`
                            ).join('');
                            suggestions.style.display = 'block';
                        } else {
                            suggestions.style.display = 'none';
                        }
                    } else {
                        suggestions.style.display = 'none';
                        symbolInfo.style.display = 'none';
                    }
                });
            } catch (error) {
                console.error('Symbol search setup error:', error);
                showError('Error setting up symbol search: ' + error.message);
            }
        }
        
        function selectSymbol(symbol) {
            try {
                const searchInput = document.getElementById('symbol-search-input');
                const suggestions = document.getElementById('suggestions');
                const symbolInfo = document.getElementById('symbol-info');
                
                searchInput.value = symbol;
                suggestions.style.display = 'none';
                
                const symbolData = dashboardData.symbol_analysis.symbol_data[symbol];
                
                if (symbolData) {
                    symbolInfo.style.display = 'block';
                    document.getElementById('selected-symbol').textContent = symbol;
                    document.getElementById('symbol-delivery').textContent = symbolData.delivery_percentage.toFixed(2) + '%';
                    document.getElementById('symbol-change').textContent = symbolData.delivery_increase_pct.toFixed(2) + '%';
                    document.getElementById('symbol-volume').textContent = symbolData.volume.toLocaleString();
                    document.getElementById('symbol-price').textContent = '‚Çπ' + symbolData.close_price.toFixed(2);
                    
                    // Update change color
                    const changeElement = document.getElementById('symbol-change');
                    if (symbolData.delivery_increase_pct > 0) {
                        changeElement.className = 'kpi-value positive';
                    } else if (symbolData.delivery_increase_pct < 0) {
                        changeElement.className = 'kpi-value negative';
                    } else {
                        changeElement.className = 'kpi-value';
                    }
                    
                    createPriceChart(symbol, symbolData);
                    createMetricsChart(symbol, symbolData);
                } else {
                    showError('Symbol data not found for: ' + symbol);
                }
            } catch (error) {
                console.error('Symbol selection error:', error);
                showError('Error selecting symbol: ' + error.message);
            }
        }
        
        function createPriceChart(symbol, data) {
            try {
                const container = document.getElementById('price-chart');
                
                const plotlyData = [{
                    x: ['Open', 'High', 'Low', 'Close'],
                    y: [data.open_price, data.high_price, data.low_price, data.close_price],
                    type: 'bar',
                    marker: {
                        color: ['#00B0FF', '#00C853', '#D50000', '#FF9800'],
                        line: { color: '#FFFFFF', width: 1 }
                    },
                    hovertemplate: '<b>%{x}</b><br>‚Çπ%{y:.2f}<extra></extra>'
                }];
                
                const layout = {
                    title: { text: symbol + ' OHLC Analysis', font: { color: '#E0E0E0' } },
                    font: { color: '#E0E0E0', family: 'Poppins' },
                    paper_bgcolor: 'transparent',
                    plot_bgcolor: 'transparent',
                    xaxis: { gridcolor: '#404040', titlefont: { color: '#E0E0E0' }, tickfont: { color: '#E0E0E0' } },
                    yaxis: { title: 'Price (‚Çπ)', gridcolor: '#404040', titlefont: { color: '#E0E0E0' }, tickfont: { color: '#E0E0E0' } },
                    margin: { t: 40, b: 40, l: 60, r: 10 }
                };
                
                Plotly.newPlot(container, plotlyData, layout, { responsive: true, displayModeBar: false });
            } catch (error) {
                console.error('Price chart error:', error);
                document.getElementById('price-chart').innerHTML = '<div class="error-message">Error loading price chart</div>';
            }
        }
        
        function createMetricsChart(symbol, data) {
            try {
                const container = document.getElementById('metrics-chart');
                
                const plotlyData = [{
                    domain: { x: [0, 1], y: [0, 1] },
                    value: data.delivery_percentage,
                    title: { text: "Delivery %" },
                    type: "indicator",
                    mode: "gauge+number+delta",
                    delta: { reference: 50 },
                    gauge: {
                        axis: { range: [null, 100] },
                        bar: { color: "#00C853" },
                        steps: [
                            { range: [0, 25], color: "#D50000" },
                            { range: [25, 50], color: "#FF9800" },
                            { range: [50, 75], color: "#00B0FF" },
                            { range: [75, 100], color: "#00C853" }
                        ],
                        threshold: {
                            line: { color: "#FFFFFF", width: 4 },
                            thickness: 0.75,
                            value: 90
                        }
                    }
                }];
                
                const layout = {
                    title: { text: symbol + ' Delivery Performance', font: { color: '#E0E0E0' } },
                    font: { color: '#E0E0E0', family: 'Poppins' },
                    paper_bgcolor: 'transparent',
                    plot_bgcolor: 'transparent',
                    margin: { t: 40, b: 20, l: 20, r: 20 }
                };
                
                Plotly.newPlot(container, plotlyData, layout, { responsive: true, displayModeBar: false });
            } catch (error) {
                console.error('Metrics chart error:', error);
                document.getElementById('metrics-chart').innerHTML = '<div class="error-message">Error loading metrics chart</div>';
            }
        }
        
    </script>
</body>
</html>
